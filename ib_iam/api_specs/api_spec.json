{
  "swagger": "2.0",
  "host": "127.0.0.1:8000",
  "basePath": "/api/ib_iam/",
  "info": {
    "version": "1.0.0",
    "title": "Authentication",
    "description": "Authentication provided for Login"
  },
  "schemes": [
    "https",
    "http"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "securityDefinitions": {
    "oauth": {
      "tokenUrl": "http://auth.ibtspl.com/oauth2/",
      "flow": "password",
      "scopes": {
        "read": "read users",
        "write": "create users",
        "update": "update users",
        "delete": "delete users"
      },
      "type": "oauth2"
    }
  },
  "definitions": {
    "HttpResponseAndStatusCode": {
      "type": "object",
      "properties": {
        "response": {
          "type": "string"
        },
        "http_status_code": {
          "type": "integer",
          "format": "int64"
        }
      },
      "required": [
        "response",
        "http_status_code"
      ]
    }
  },
  "parameters": {
    "LoginParameter": {
      "name": "login",
      "description": "email and password to login in database",
      "in": "body",
      "required": true,
      "schema": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string"
          },
          "password": {
            "type": "string"
          }
        },
        "required": [
          "email",
          "password"
        ]
      }
    },
    "ResetPasswordParameter": {
      "name": "ResetPasswordParameter",
      "description": "email to reset the password",
      "in": "body",
      "required": true,
      "schema": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string"
          }
        },
        "required": [
          "email"
        ]
      }
    },
    "UpdatePasswordParameter": {
      "name": "UpdatePasswordParameter",
      "description": "update password of user",
      "in": "body",
      "required": true,
      "schema": {
        "type": "object",
        "properties": {
          "password": {
            "type": "string"
          }
        },
        "required": [
          "password"
        ]
      }
    }
  },
  "responses": {
    "LoginInSuccessResponse": {
      "description": "Success Response for login",
      "schema": {
        "type": "object",
        "properties": {
          "access_token": {
            "type": "string"
          },
          "refresh_token": {
            "type": "string"
          },
          "expires_in_seconds": {
            "type": "integer",
            "format": "int64"
          },
          "is_admin": {
            "type": "boolean"
          }
        },
        "required": [
          "access_token",
          "refresh_token",
          "expires_in_seconds",
          "is_admin"
        ]
      }
    },
    "LoginInBadRequestResponse": {
      "description": "Log in Bad Request Response",
      "schema": {
        "allOf": [
          {
            "$ref": "#/definitions/HttpResponseAndStatusCode"
          },
          {
            "type": "object",
            "properties": {
              "res_status": {
                "type": "string",
                "enum": [
                  "INVALID_EMAIL",
                  "PASSWORD_MIN_LENGTH",
                  "PASSWORD_AT_LEAST_ONE_SPECIAL_CHARACTER"
                ]
              }
            },
            "required": [
              "res_status"
            ]
          }
        ]
      }
    },
    "LoginInNotFoundResponse": {
      "description": "Login In Not Found response",
      "schema": {
        "allOf": [
          {
            "$ref": "#/definitions/HttpResponseAndStatusCode"
          },
          {
            "type": "object",
            "properties": {
              "res_status": {
                "type": "string",
                "enum": [
                  "USER_ACCOUNT_DOES_NOT_EXIST",
                  "INCORRECT_PASSWORD"
                ]
              }
            },
            "required": [
              "res_status"
            ]
          }
        ]
      }
    },
    "ResetPasswordBadRequestResponse": {
      "description": "reset password bad request response",
      "schema": {
        "allOf": [
          {
            "$ref": "#/definitions/HttpResponseAndStatusCode"
          },
          {
            "type": "object",
            "properties": {
              "res_status": {
                "type": "string",
                "enum": [
                  "INVALID_EMAIL"
                ]
              }
            },
            "required": [
              "res_status"
            ]
          }
        ]
      }
    },
    "ResetPasswordNotFoundResponse": {
      "description": "reset password not found response",
      "schema": {
        "allOf": [
          {
            "$ref": "#/definitions/HttpResponseAndStatusCode"
          },
          {
            "type": "object",
            "properties": {
              "res_status": {
                "type": "string",
                "enum": [
                  "USER_ACCOUNT_DOES_NOT_EXIST"
                ]
              }
            },
            "required": [
              "res_status"
            ]
          }
        ]
      }
    },
    "UpdatePasswordBadRequestResponse": {
      "description": "update password bad request response",
      "schema": {
        "allOf": [
          {
            "$ref": "#/definitions/HttpResponseAndStatusCode"
          },
          {
            "type": "object",
            "properties": {
              "res_status": {
                "type": "string",
                "enum": [
                  "NOT_STRONG_PASSWORD",
                  "TOKEN_HAS_EXPIRED"
                ]
              }
            },
            "required": [
              "res_status"
            ]
          }
        ]
      }
    },
    "UpdatePasswordNotFoundResponse": {
      "description": "update password not found response",
      "schema": {
        "allOf": [
          {
            "$ref": "#/definitions/HttpResponseAndStatusCode"
          },
          {
            "type": "object",
            "properties": {
              "res_status": {
                "type": "string",
                "enum": [
                  "TOKEN_DOES_NOT_EXIST"
                ]
              }
            },
            "required": [
              "res_status"
            ]
          }
        ]
      }
    }
  },
  "paths": {
    "/login/v1/": {
      "post": {
        "operationId": "user_login",
        "summary": "user login",
        "description": "if user is exists return the access_token and is_admin",
        "security": [
          {
            "oauth": [
              "read"
            ]
          }
        ],
        "parameters": [
          {
            "$ref": "#/parameters/LoginParameter"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/responses/LoginInSuccessResponse"
          },
          "404": {
            "$ref": "#/responses/LoginInNotFoundResponse"
          },
          "400": {
            "$ref": "#/responses/LoginInBadRequestResponse"
          }
        }
      }
    },
    "/logout/v1/": {
      "post": {
        "operationId": "user_logout",
        "summary": "user logout",
        "description": "user want to log out from a device",
        "security": [
          {
            "oauth": [
              "write"
            ]
          }
        ],
        "responses": {
          "200": {
            "description": "Success Response"
          }
        }
      }
    },
    "/rest_password_link/v1/": {
      "post": {
        "operationId": "user_reset_password_link",
        "summary": "user reset password link",
        "description": "user reset password link to email",
        "security": [
          {
            "oauth": [
              "read"
            ]
          }
        ],
        "parameters": [
          {
            "$ref": "#/parameters/ResetPasswordParameter"
          }
        ],
        "responses": {
          "400": {
            "$ref": "#/responses/ResetPasswordBadRequestResponse"
          },
          "404": {
            "$ref": "#/responses/ResetPasswordNotFoundResponse"
          },
          "200": {
            "description": "Success Response"
          }
        }
      }
    },
    "/update_password/v1/": {
      "post": {
        "summary": "update user the password",
        "operationId": "update_user_password",
        "description": "update user password using token which we provided",
        "security": [
          {
            "oauth": [
              "write"
            ]
          }
        ],
        "parameters": [
          {
            "name": "token",
            "in": "query",
            "description": "user token with expires secs",
            "type": "integer",
            "required": true
          },
          {
            "$ref": "#/parameters/UpdatePasswordParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "Success Response"
          },
          "400": {
            "$ref": "#/responses/UpdatePasswordBadRequestResponse"
          },
          "404": {
            "$ref": "#/responses/UpdatePasswordNotFoundResponse"
          }
        }
      }
    }
  }
}