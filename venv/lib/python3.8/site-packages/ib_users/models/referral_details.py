from django.db import models

from ib_common.models import AbstractDateTimeModel

from ib_users.constants.referral_constants import REFERRAL_CODE_LENGTH


class ReferralDetails(AbstractDateTimeModel):
    referral_code = models.CharField(max_length=REFERRAL_CODE_LENGTH,
                                     unique=True)
    referral_limit = models.IntegerField()
    user_account = models.OneToOneField(
        'UserAccount',
        on_delete=models.CASCADE,
        null=True
    )
    referred_by = models.ForeignKey(
        'self',
        on_delete=models.CASCADE,
        related_name='referrer_details',
        null=True
    )

    def __str__(self):
        return self.referral_code

    class Meta(object):
        app_label = 'ib_users'
