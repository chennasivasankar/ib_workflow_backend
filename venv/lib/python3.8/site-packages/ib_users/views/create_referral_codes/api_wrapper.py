from django_swagger_utils.drf_server.utils.decorator.interface_decorator \
    import validate_decorator
from .validator_class import ValidatorClass


@validate_decorator(validator_class=ValidatorClass)
def api_wrapper(*args, **kwargs):
    request_data = kwargs['request_data']
    from ib_users.constants.referral_constants import \
        DEFAULT_REFERRAL_CODES_CREATION_COUNT
    no_of_referrals = DEFAULT_REFERRAL_CODES_CREATION_COUNT
    try:
        no_of_referrals = request_data['no_of_referrals']
    except KeyError:
        pass
    from ib_users.interactors.referrals_interactor import ReferralsInteractor
    from ib_users.storages.referrals_storage_impl import ReferralsSQLStorage
    from ib_users.presenters.referrals_presenter_impl import \
        ReferralsPresenterJSON

    storage = ReferralsSQLStorage()
    presenter = ReferralsPresenterJSON()
    interactor = ReferralsInteractor(storage=storage, presenter=presenter)
    created_referral_codes = interactor.get_new_referral_codes(
        no_of_referral_codes=no_of_referrals)

    return created_referral_codes
