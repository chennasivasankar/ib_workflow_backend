from ib_users.interactors.storages import UserAccountsStorage
from ib_users.interactors.third_party.user_tokens_generator import \
    UserAuthTokensGenerator


class DeactivateUserInteractor:

    def __init__(self, storage: UserAccountsStorage,
                 auth_service: UserAuthTokensGenerator):
        self.storage = storage
        self.auth_service = auth_service

    def deactivate(self, user_id):
        self.auth_service.expire_all_user_tokens(
            user_id=user_id
        )
        self.storage.update_user_active_status(
            user_id=user_id, is_active=False
        )
