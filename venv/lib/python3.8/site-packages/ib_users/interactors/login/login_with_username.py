from ib_users.interactors.login.base_login import BaseLogin
from ib_users.interactors.storages import UserAccountsStorage
from ib_users.validators import UsernameValidator, PasswordValidator


class LoginWithUsername(BaseLogin):
    def __init__(self, storage: UserAccountsStorage):
        super().__init__(storage)

    def get_user_id_for_given_login_data(self,
                                         username_and_password_dto):
        UsernameValidator.validate(username_and_password_dto.username)
        PasswordValidator.validate(username_and_password_dto.password)
        user_id = self.storage.get_user_id_given_username_and_password(
            username_and_password_dto)
        super().validate_user_account_for_active_state(user_id)
        return user_id
