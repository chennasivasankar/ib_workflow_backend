from ib_users.interactors.storages.user_accounts_storage import \
    EmailAndPasswordDTO, UserAccountsStorage
from ib_users.validators import EmailValidator, PasswordValidator
from ib_users.interactors.login.base_login import BaseLogin


class LoginWithEmail(BaseLogin):

    def __init__(self, storage: UserAccountsStorage):
        super().__init__(storage)

    def get_user_id_for_given_login_data(self,email_login_dto: EmailAndPasswordDTO):
        EmailValidator.validate(email_login_dto.email)
        PasswordValidator.validate(email_login_dto.password)
        user_id = self.storage.get_user_id_given_email_and_password(
            email_login_dto)
        super().validate_user_account_for_active_state(user_id)
        return user_id
