import abc
from typing import List
from uuid import UUID

from ib_users.interactors.storages.user_login_device_details_storage import \
    UserLoginDeviceDetailsStorage
from ib_users.interactors.third_party.user_tokens_generator import \
    UserAuthTokensGenerator


class LogoutInDevices:
    __metaclass__ = abc.ABCMeta

    def __init__(self, storage: UserLoginDeviceDetailsStorage,
                 login_token_generator: UserAuthTokensGenerator):
        self.login_token_generator = login_token_generator
        self.storage = storage

    @abc.abstractmethod
    def logout_in_all_devices(self, user_id: str):
        pass

    @abc.abstractmethod
    def logout_in_devices_except_of_given_access_tokens(
            self,
            user_id,
            access_tokens: List[str]):
        pass
