import pyotp
from ib_users.interactors.third_party.otp_provider import OTPProvider


class PyOTPProvider(OTPProvider):

    def generate_time_based_code_for_user(
            self, user_secret: str, configured_time_in_seconds: int) -> str:

        otp = pyotp.TOTP(user_secret, interval=configured_time_in_seconds)
        return otp.now()
