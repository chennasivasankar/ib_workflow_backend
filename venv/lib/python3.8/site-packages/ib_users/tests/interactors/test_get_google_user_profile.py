from mock import create_autospec


def test_get_google_user_profile_return_profile():
    from ib_users.interactors.google_interactor import \
        GoogleInteractor
    from ib_users.interactors.presenters.google_presenter \
        import GooglePresenter
    from ib_users.interactors.third_party.google_provider \
        import GoogleProvider

    google_provider_mock = create_autospec(GoogleProvider)
    google_presenter_mock = create_autospec(GooglePresenter)

    google_interactor = GoogleInteractor(provider=google_provider_mock,
                                         presenter=google_presenter_mock)
    access_token = "access_token"

    from ib_users.interactors.third_party.google_provider import GoogleProfileDTO
    google_user_profile = GoogleProfileDTO(
        name="Robert",
        profile_pic=""
    )

    google_provider_mock.get_user_profile.return_value = google_user_profile

    google_interactor.get_google_user_profile_by_access_token(access_token)
    google_provider_mock.get_user_profile.assert_called_once_with(
        access_token=access_token)
    google_presenter_mock.get_user_profile.assert_called_once_with(
        google_user_profile)
